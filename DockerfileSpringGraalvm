FROM ghcr.io/graalvm/graalvm-community:21 AS builder
WORKDIR /build
COPY . /build
RUN ./mvnw --no-transfer-progress native:compile -Pnative  -e
FROM container-registry.oracle.com/os/oraclelinux:9-slim
EXPOSE 8080
COPY --from=0 "/build/target/spring-native-graalvm" spring-native-graalvm
CMD [ "sh", "-c", "./spring-native-graalvm" ]